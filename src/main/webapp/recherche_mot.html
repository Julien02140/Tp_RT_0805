<body>
    <div id="base-content"></div>

    <h1>Bienvenue, <span id="mot"></span>!</h1>

    <!-- <h1>Bienvenue, <span id="poster_path"></span>!</h1> -->

    <!-- <pre id="json-container"></pre> -->


    <div id="films-list"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            const urlParams = new URLSearchParams(window.location.search);
            const mot = urlParams.get('mot');

            document.getElementById('mot').textContent = mot;
            
            fetch("/rest/trouver_film_mot?mot=" + mot)
                .then(response => response.json())
                .then(films => {
                    // const jsonContainer = document.getElementById('json-container');
                    // jsonContainer.textContent = JSON.stringify(films, null, 2); // Formatage avec 2 espaces pour la lisibilité
                    // document.getElementById('poster_path').textContent = "https://image.tmdb.org/t/p/w342" + films[0].posterPath;
                    const filmsList = document.getElementById('films-list');
                    const ul = document.createElement('ul');
                    ul.classList.add('film-list');

                    films.forEach(film => {
                        const li = document.createElement('li');
                        li.classList.add('film-list-item');
                        li.setAttribute('data-bs-toggle', 'tooltip');
                        li.setAttribute('data-bs-placement', 'top');

                        const h5 = document.createElement('h5');
                        h5.textContent = film.title;

                        const a = document.createElement('a');
                        a.href = "/rest/description_film?film_id=" + film.id;

                        const img = document.createElement('img');
                        img.src = "https://image.tmdb.org/t/p/w342" + film.posterPath;
                        img.alt = film.title + " Poster";

                        a.appendChild(img);

                        li.appendChild(h5);
                        li.appendChild(a);
                        
                        ul.appendChild(li);
                    });
                    filmsList.appendChild(ul);
                })
                .catch(error => console.error('Erreur lors de la récupération des films:', error));

            fetch('base_site.html')
                .then(response => response.text())
                .then(data => {
                    document.getElementById('base-content').innerHTML = data;
                });
        });

    </script>
</body>
</html>